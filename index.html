<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- 引入代码高亮插件样式 -->
  <link href="http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css" rel="stylesheet" />
  <!-- 引入阿里云ico图标样式 -->
  <link rel="stylesheet" href="http://at.alicdn.com/t/font_2161824_78bvz3356e.css" />

  <title>wangEditor示例</title>
  <style>
    #div1 {
      margin: 10px auto;
      width: 90%;
    }
    .info{
      width: 90%;
      padding-left: 20px;
    }
  </style>
</head>

<body>
  <div class='info'>
    <h2>wangEditor示例</h2>
    <ul>
      <li><h3>所有基本功能</h3></li>
      <li><h3>引入公式编辑器kityformula</h3></li>
      <li><h3>引入公式手写板功能</h3></li>
      <li><h3>添加代码高亮显示功能</h3></li>
    </ul>
  </div>
  <div id="div1"></div>
</body>

<script type="text/javascript" src="./node_modules/wangeditor/dist/wangEditor.min.js"></script>
<!-- 代码高亮插件 -->
<script src="http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js"></script>

<script type="text/javascript" src="./kityformula.js"></script>
<script type="text/javascript" src="./myscript-math-web.js"></script>
<!-- <script type="text/javascript" src="./test.js"></script> -->
<script type="text/javascript">
  // console.log(window.wangEditor);
  const E = window.wangEditor;
  const editor = new E("#div1");
  const {
    $,
    BtnMenu,
    DropListMenu,
    PanelMenu,
    DropList,
    Panel,
    Tooltip
  } = E;

  // 继承PanelMenu的公式功能
  class Kityformula extends PanelMenu {
    // 公式编辑器
    constructor(editor) {
      // data-title属性表示当鼠标悬停在该按钮上时提示该按钮的功能简述
      const $elem = E.$(
        `<div class="w-e-menu">
                  <i class="iconfont icongongshi" style="font-size:18px;"></i>
              </div>`
      );
      super($elem, editor);
    }
    // 菜单点击事件
    clickHandler() {
      // 做任何你想做的事情
      // 可参考【常用 API】文档，来操作编辑器

      // alert('hello world')
      const conf = createKityformula(editor);
      console.log(conf);
      const panel = new Panel(this, conf);
      panel.create();
    }
    // 菜单是否被激活（如果不需要，这个函数可以空着）
    tryChangeActive() {
      // 激活菜单
      // 1. 菜单 DOM 节点会增加一个 .w-e-active 的 css class
      // 2. this.this.isActive === true
      // this.active()
      // // 取消激活菜单
      // // 1. 菜单 DOM 节点会删掉 .w-e-active
      // // 2. this.this.isActive === false
      // this.unActive()
    }
  }

  // 继承PanelMenu的手写板功能
  class Myscript extends PanelMenu {
    // 公式手写插件
    constructor(editor) {
      const $elem = E.$(
        `<div class="w-e-menu">
                  <i class="iconfont iconshouxieban" style="font-size:18px;"></i>
              </div>`
      );
      super($elem, editor);
    }
    // 菜单点击事件
    clickHandler() {
      // 做任何你想做的事情
      // 可参考【常用 API】文档，来操作编辑器
      const conf = myscriptMath(editor);
      const panel = new Panel(this, conf);
      panel.create();
    }

    tryChangeActive() {}
  }
  // 注册公式菜单
  const menuKey = "kityformulaKey"; // 菜单 key ，各个菜单不能重复
  editor.menus.extend("kityformulaKey", Kityformula);
  // 注册手写板菜单
  const menuKey2 = "myscriptKey"; // 菜单 key ，各个菜单不能重复
  editor.menus.extend("myscriptKey", Myscript);

  // 注册菜单
  E.registerMenu(menuKey, Kityformula);
  E.registerMenu(menuKey2, Myscript)

  // 挂载highlight插件
  editor.highlight = hljs;
  // 配置 server 接口地址
  editor.config.uploadImgServer = "./upload-img";
  editor.create();
</script>

</html>